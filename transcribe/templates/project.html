{% extends 'page.html' %}

{% block title %}Project Details{% endblock title %}

{% block page_link %}<a href="{% url "edit_project" project.id %}">Edit</a>{% endblock page_link %}

{% block content %}
<div class="project-details">
    <h1>{{ project.name }}</h1>

	<div class="group">
		<label>Users</label>
		<section>
			<ul>
				{% for user in project.users.all %}
				<li><b>{% if user.name %}{{ user.name }} ({{ user.email }}){% else %}{{ user.email }}{% endif %}:</b> {{ project.items.all|length }} item{% if project.items.all|length != 1 %}s{% endif %}</li>
				{% empty %}
				<li>Nobody yet. <a href="{% url "edit_project" project.id %}">Add some &rarr;</a></li>
				{% endfor %}
			</ul>
		</section>
	</div>

	<div class="group">
		<label>{{ project.items.all|length }} Item{% if project.items.all|length != 1 %}s{% endif %}</label>
		<section>
			<ul class="items">
                {% for item in project.items.all %}
                <li class="{{ item.status }}">
					<a href="{% url 'transcribe_item' project.id item.id %}">{{ item.name }}</a> &mdash; {{ item.type }} ({{ item.source_type }})
					{% if item.transcripts.all|length > 0 %}
					<ul>
                        {% for transcript in item.transcripts.all %}
                        <li class="{{ transcript.status }}">{{ transcript.date|date:"j F Y" }} &mdash; {{ transcript.owner.name }} &mdash; {{ transcript.status }}</li>
                        {% endfor %}
					</ul>
                    {% endif %}
				</li>
                {% endfor %}
			</ul>
		</section>
	</div>

	<div class="group">
		<label>Download</label>
		<section>
			<ul>
				<li><a href="">Download transcript</a> (text)</li>
				<li><a href="">Download transcript</a> (PDF)</li>
				<li><a href="">Download project history</a> (JSON)</li>
			</ul>
		</section>
	</div>

	<div class="group">
		<label>&nbsp;</label>
		<section>
			<ul>
				<li><a class="delete-project-link" href="">Delete project</a></li>
			</ul>
		</section>
	</div>
</div>

{% endblock content %}

{% block modal %}
<form class="delete-project">
	<a class="cancel-link">No, whoops, so sorry</a>
	<h2>Delete Project</h2>

	<p>Are you really, really sure you want to send this project to the chopping block?</p>

	<input type="submit" value="Heck Yes" data-id="{{ project.id }}" />
</form>
{% endblock modal %}
